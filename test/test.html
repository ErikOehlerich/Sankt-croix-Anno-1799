let currentExcelFile = ""; // Gemmer den aktuelle Excel-fil

// Funktion til at læse Excel-filen og vise indholdet
function readExcel(file) {
    currentExcelFile = file; // Gem filnavnet globalt
    const xhr = new XMLHttpRequest();
    xhr.open('GET', file, true);
    xhr.responseType = 'arraybuffer';

    xhr.onload = function(e) {
        const data = new Uint8Array(xhr.response);
        const workbook = XLSX.read(data, { type: 'array' });
        const firstSheetName = workbook.SheetNames[0];
        const worksheet = workbook.Sheets[firstSheetName];

        // Generer HTML fra Excel-data
        const html = XLSX.utils.sheet_to_html(worksheet, { header: 1 });
        document.getElementById('excelContent').innerHTML = html;
    };

    xhr.send();
}

// Funktion til at vise Excel i fuldskærm
function showExcelFullscreen() {
    const excelContent = document.getElementById('excelContent');

    // Hvis der ikke er noget Excel-indhold, prøv at indlæse filen igen
    if (!excelContent || excelContent.innerHTML.trim() === "") {
        if (currentExcelFile) {
            readExcel(currentExcelFile);
            setTimeout(showExcelFullscreen, 500); // Forsinket genkald for at sikre, at filen er indlæst
        } else {
            alert("Indlæs Excel-filen først for at vise den i fuldskærm!");
            return;
        }
    }

    const fullScreenDiv = document.createElement('div');
    fullScreenDiv.style.position = 'fixed';
    fullScreenDiv.style.top = '0';
    fullScreenDiv.style.left = '0';
    fullScreenDiv.style.width = '100%';
    fullScreenDiv.style.height = '100%';
    fullScreenDiv.style.backgroundColor = 'white';
    fullScreenDiv.style.zIndex = '10000';
    fullScreenDiv.style.overflow = 'auto';
    fullScreenDiv.innerHTML = `<h2>Excel Indhold</h2>${excelContent.innerHTML}`;
    fullScreenDiv.onclick = function() {
        document.body.removeChild(fullScreenDiv); // Luk fuldskærm ved at klikke
    };
    document.body.appendChild(fullScreenDiv);
}
