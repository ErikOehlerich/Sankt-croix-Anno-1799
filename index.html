<!DOCTYPE html>
<html lang="da">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kort over plantager på Sankt Croix i 1799</title>

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet-draw/dist/leaflet.draw.css" />
    
 <!-- Leaflet MarkerCluster CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.Default.css" />


    <!-- XLSX.js for reading Excel files -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>

    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            font-family: Arial, sans-serif;
        }
        #map {
            height: 600px;  /* Kortets højde */
            width: 100%;  /* Kortets bredde */
            position: relative;
        }
        h1 {
            text-align: center;
            margin-top: 20px;
        }
        #footer {
            position: fixed;
            bottom: 10px;
            left: 10px;
            background-color: #fff;
            padding: 5px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }
        .popup-content {
            max-width: 400px; /* Maksimal bredde af popuppen */
            overflow: auto; /* Tillad scrolling, hvis indholdet er for stort */
        }
        .excel-table {
            max-height: 300px; /* Sætter maksimal højde på Excel-tabellen */
            overflow-y: auto; /* Tillader lodret scrolling */
            margin-top: 10px; /* Margin for lidt afstand fra billedet */
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        table, th, td {
            border: 1px solid #ddd;
        }
        th, td {
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        /* Værktøjsboks stil */
        .tools-container {
            position: fixed; /* Flyt værktøjsboksen til fixed position */
            bottom: 200px; /* Placering til venstre */
            left: 50%; /* Placering til venstre */
            background-color: white;
            padding: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            z-index: 1000; /* Højere end kortet */
            margin-bottom: 20px; /* Margin til at forhindre overlap */
        }
        .tools-container.measure {
            left: 40%;
        }
        .tools-container.coordinates {
            left: 55%; /* Skift til højre for koordinatværktøjet */
            margin-bottom: 70px; /* Øg margin til at forhindre overlap med footer */
        }
        
        
  /* Begræns billedets størrelse i popuppen */
  .popup-content img {
    max-width: 100px; /* Begræns bredden */
    height: auto;     /* Bevar proportionerne */
    display: block;   /* Forhindrer inline layout-forstyrrelser */
    margin: 5px 0;    /* Tilføj lidt afstand omkring billederne */
  }
    </style>


</head>
<body>
    <h1>Sanct Croix Anno 1799</h1>
    <div id="map"></div>
    <div id="footer">Udarbejdet af Erik Luis Lanuza Oehlerich</div>
    
    <!-- Værktøjer -->
    <div class="tools-container measure">
        <h3>Måleværktøj</h3>
        <button id="measureBtn">Aktiver Måleværktøj</button>
        <button id="stopMeasureBtn" style="display:none;">Deaktiver Måleværktøj</button>
    </div>
    
    <div class="tools-container coordinates">
        <h3>Koordinat Vælger</h3>
        <button id="coordinateBtn">Aktiver Koordinat Vælger</button>
        <button id="stopCoordinateBtn" style="display:none;">Deaktiver Koordinat Vælger</button>
    </div>

    <!-- Leaflet JavaScript -->
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet-draw/dist/leaflet.draw.js"></script>

      <!-- Leaflet MarkerCluster JavaScript -->
    <script src="https://unpkg.com/leaflet.markercluster/dist/leaflet.markercluster.js"></script>

    <script>
        // Initialiser kortet
        var map = L.map('map').setView([17.7421648, -64.7560983], 12); // Centrer kortet

        // Definer baggrundskortene
        var osm = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
            maxZoom: 19
        });

        var googleSat = L.tileLayer('https://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}', {
            attribution: '© Google',
            subdomains: ['mt0', 'mt1', 'mt2', 'mt3'],
            maxZoom: 20
        });

        var googleStreets = L.tileLayer('https://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}', {
            attribution: '© Google',
            subdomains: ['mt0', 'mt1', 'mt2', 'mt3'],
            maxZoom: 20
        });

        var mapbox = L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=your.mapbox.access.token', {
            attribution: '© <a href="https://www.mapbox.com/about/maps/">Mapbox</a>',
            id: 'mapbox/streets-v11',
            tileSize: 512,
            zoomOffset: -1,
            maxZoom: 20
        });

        // Definer dine tile layers som overlay
        var customTiles = L.tileLayer('https://erikoehlerich.github.io/Map-of-Sanct-Croix-tiles/{z}/{x}/{y}.png', {
            attribution: '© Erik Oehlerich',
            maxZoom: 19
        });

        // Tilføj baggrundskort som basislag
        var baseLayers = {
            "OpenStreetMap": osm,
            "Google Satellite": googleSat,
            "Google Streets": googleStreets,
            "Mapbox Streets": mapbox
        };

        // Tilføj custom tiles som overlay og slå det til som standard
        var overlays = {
            "Custom Tiles": customTiles
        };

        // Tilføj baseLayers og overlays til kortet
        L.control.layers(baseLayers, overlays).addTo(map);

        // Tilføj OSM som standard baggrundskort
        osm.addTo(map);
        customTiles.addTo(map);

       // Opret en marker cluster gruppe
        var markers = L.markerClusterGroup({
            spiderfyOnMaxZoom: true,
            showCoverageOnHover: false,
            zoomToBoundsOnClick: true
        });


        // Array af punkter

       

        // East End A: Kvarter
        // East End B: Kvarter
        // Kompagniets Kvarter
var points = [
 // Dronningens Kvarter
{
        coordinates: [17.7687222, -64.747195],
        navn: "Matrikel nr. 1, Judith’s Fancy",
        nabolag: "Dronningens Kvarter",
        ejer: "the Heirs John Bennens Esqr",
        image: 'Dronningens_distrikt/point1/4.jpg',
        excelLink: 'Dronningens_distrikt/point1/point1_4_1.xlsx'
    },
{
        coordinates: [17.763757, -64.745564],
        navn: "Matrikel nr. 2, St. John",
        nabolag: "Dronningens Kvarter",
        ejer: "John Heyliger Burt",
        image: 'Dronningens_distrikt/point2/7.jpg',
        excelLink: 'Dronningens_distrikt/point2/point2_7_1.xlsx'
    },
{
        coordinates: [17.762306, -64.758675],
        navn: "Matrikel nr. 3 & 10, Montpiller",
        nabolag: "Dronningens Kvarter",
        ejer: "Counsellor Lillienschjold",
        image: 'Dronningens_distrikt/point3/10.jpg',
        excelLink: 'Dronningens_distrikt/point3/point3_10_1.xlsx'
    },
    {
        coordinates: [17.759495, -64.77715],
        navn: "Matrikel nr. 6, Windson",
        nabolag: "Dronningens Kvarter",
        ejer: "G M Brotherson & Mrs Elizabeth Chabert",
        image: ['Dronningens_distrikt/point6/18.jpg',
               'Dronningens_distrikt/point6/20.png'],
        excelLink: ['Dronningens_distrikt/point6/point6_18_1.xlsx',
                   'Dronningens_distrikt/point6/point6_20_1.xlsx']
    },
{
        coordinates: [17.752272, -64.774468],
        navn: "Matrikel nr. 7, The Glynn",
        nabolag: "Dronningens Kvarter",
        ejer: "James Johnson",
        image: 'Dronningens_distrikt/point7/22.png',
        excelLink: 'Dronningens_distrikt/point7/point7_22_1.xlsx'
    },
 {
        coordinates: [17.75266, -64.767301],
        navn: "Matrikel nr. 8, Concordia",
        nabolag: "Dronningens Kvarter",
        ejer: "Samuel Foster Esqr & William Knox & Joseph P: Maillard",
        image: ['Dronningens_distrikt/point8/11.jpg',
               'Dronningens_distrikt/point8/12.jpg',
            'Dronningens_distrikt/point8/13.jpg',
            'Dronningens_distrikt/point8/14.jpg',
            'Dronningens_distrikt/point8/15.jpg'],
        excelLink: ['Dronningens_distrikt/point8/point8_11_1.xlsx',
                   'Dronningens_distrikt/point8/point8_12_1.xlsx',
                     'Dronningens_distrikt/point8/point8_13_1.xlsx',
                     'Dronningens_distrikt/point8/point8_14_1.xlsx',
                     'Dronningens_distrikt/point8/point8_15_1.xlsx']
    },
{
        coordinates: [17.752415, -64.761829],
        navn: "Matrikel nr. 9, Morning Star",
        nabolag: "Dronningens Kvarter",
        ejer: "William Macdougal & James Lawson",
        image: ['Dronningens_distrikt/point9/25.png',
                'Dronningens_distrikt/point9/28.jpg'],
        excelLink: ['Dronningens_distrikt/point9/point9_25_1.xlsx',
                    'Dronningens_distrikt/point9/point9_28_1.xlsx']
    },
{
        coordinates: [17.750719, -64.744256],
        navn: "Matrikel nr. 13 & 14, Rattan & Bellindere",
        nabolag: "Dronningens Kvarter",
        ejer: "George Aitkin Esquire",
        image: 'Dronningens_distrikt/point13/29.jpg',
        excelLink: 'Dronningens_distrikt/point13/point13_29_1.xlsx'
    },
{
        coordinates: [17.745998, -64.762259],
        navn: "Matrikel nr. 16 & 17, Marys Fancys",
        nabolag: "Dronningens Kvarter",
        ejer: "Heirs of C. De Nelly",
        image: 'Dronningens_distrikt/point16/31.jpg',
        excelLink: 'Dronningens_distrikt/point16/point16_31_1.xlsx'
    },

{
        coordinates: [17.744372, -64.771314],
        navn: "Matrikel nr. 18,  Bonne Esperance",
        nabolag: "Dronningens Kvarter",
        ejer: "Benners & Kenney & George Allan & Andrew Kenny",
        image: ['Dronningens_distrikt/point18/34.jpg',
                'Dronningens_distrikt/point18/35.jpg',
                'Dronningens_distrikt/point18/36.jpg',],
        excelLink: ['Dronningens_distrikt/point18/point18_34_1.xlsx',
                    'Dronningens_distrikt/point18/point18_35_1.xlsx',
                    'Dronningens_distrikt/point18/point18_36_1.xlsx']
    },
{
        coordinates: [17.734574, -64.765198],
        navn: "Matrikel nr. 19, Limetree",
        nabolag: "Dronningens Kvarter",
        ejer: "Isaac Hartman Esqr",
        image: 'Dronningens_distrikt/point19/37.jpg',
        excelLink: 'Dronningens_distrikt/point19/point19_37_1.xlsx'
    },
{
        coordinates: [17.736842, -64.762237],
        navn: "Matrikel nr. 20, Limetree",
        nabolag: "Dronningens Kvarter",
        ejer: "Robert Suite & Richard Suite",
        image: ['Dronningens_distrikt/point20/47.jpg',
                      'Dronningens_distrikt/point20/50.jpg'],
        excelLink: ['Dronningens_distrikt/point19/point20_47_1.xlsx',
                      'Dronningens_distrikt/point19/point20_50_1.xlsx']
    },
    {
        coordinates: [17.738854, -64.75625],
        navn: "Matrikel nr. 21, Ruby",
        nabolag: "Dronningens Kvarter",
        ejer: "Samuel Huyghue",
        image: 'Dronningens_distrikt/point21/39.jpg',
        excelLink: 'Dronningens_distrikt/point21/point21_39_1.xlsx'
    },
    {
        coordinates: [17.741216, -64.748418],
        navn: "Matrikel nr. 22, Sion Hill",
        nabolag: "Dronningens Kvarter",
        ejer: "Thomas Bradshaw Esqr.",
        image: 'Dronningens_distrikt/point22/40.jpg',
        excelLink: 'Dronningens_distrikt/point22/point22_40_1.xlsx'
    },
{
        coordinates: [17.735207, -64.735072],
        navn: "Matrikel nr. 25, Constitution Hill ",
        nabolag: "Dronningens Kvarter",
        ejer: "Samuel Foster Esqur & Franken England",
        image: ['Dronningens_distrikt/point25/43.jpg',
                'Dronningens_distrikt/point25/46.jpg'],
        excelLink: ['Dronningens_distrikt/point25/point25_43_1.xlsx',
                    'Dronningens_distrikt/point25/point25_46_1.xlsx']
    },
{
        coordinates: [17.729657, -64.759212],
        navn: "Matrikel nr. 29, Strawberry Hill ",
        nabolag: "Dronningens Kvarter",
        ejer: "Alexr. & the Heirs of John Tower",
        image: ['Dronningens_distrikt/point29/23.jpg',
                'Dronningens_distrikt/point29/51.jpg',
                'Dronningens_distrikt/point29/52.jpg'],
        excelLink: ['Dronningens_distrikt/point29/point29_23_1.xlsx',
                    'Dronningens_distrikt/point29/point29_51_1.xlsx',
                    'Dronningens_distrikt/point29/point29_52_1.xlsx']
    },
{        coordinates: [17.727563, -64.765735],
        navn: "Matrikel nr. 30, Moir / Lime tree? ",
        nabolag: "Dronningens Kvarter",
        ejer: "Sams Sonson",
        image: ['Dronningens_distrikt/point30/56.jpg',
                'Dronningens_distrikt/point30/57.jpg'],
        excelLink: ['Dronningens_distrikt/point30/point30_56_1.xlsx',
                    'Dronningens_distrikt/point30/point30_57_1.xlsx']
    },

{        coordinates: [17.705211, -64.787107],
        navn: "Matrikel nr. 33 & 34, Castle Coakley",
        nabolag: "Dronningens Kvarter",
        ejer: "Heirs of John and Elizabeth Coakley & Robert Ronson & John B. Barnes",
        image: ['Dronningens_distrikt/point34/61.jpg',
                'Dronningens_distrikt/point34/64.jpg'],
        excelLink: ['Dronningens_distrikt/point34/point34_61_1.xlsx',
                    'Dronningens_distrikt/point34/point34_64_1.xlsx']
    },
 {
        coordinates: [17.760884, -64.771399],
        navn: "Matrikel nr. 35, Pieters Rock",
        nabolag: "Dronningens Kvarter",
        ejer: "Heirs of C. De Nully Deceased",
        image: 'Dronningens_distrikt/point35/66.jpg',
        excelLink: 'Dronningens_distrikt/point35/point35_66_1.xlsx'
    },
{        coordinates: [17.719551, -64.729514],
        navn: "Matrikel nr. 37, Work & rest Estate ",
        nabolag: "Dronningens Kvarter",
        ejer: "John Heyliger & Beny Reynold",
        image: ['Dronningens_distrikt/point37/68.jpg',
                'Dronningens_distrikt/point37/70.jpg'],
        excelLink: ['Dronningens_distrikt/point37/point37_68_1.xlsx',
                    'Dronningens_distrikt/point37/point37_70_1.xlsx']
    },
     {
        coordinates: [17.718529, -64.736381],
        navn: "Matrikel nr. 38, Rose",
        nabolag: "Dronningens Kvarter",
        ejer: " Will Amistrong Esqr",
        image: 'Dronningens_distrikt/point38/72.jpg',
        excelLink: 'Dronningens_distrikt/point38/point38_72_1.xlsx'
    },

    {        coordinates: [17.711988, -64.746809],
        navn: "Matrikel nr. 40, Jerusalem",
        nabolag: "Dronningens Kvarter",
        ejer: " John Dewints Esqr & Count Rantzow ",
        image: ['Dronningens_distrikt/point40/75.jpg',
                'Dronningens_distrikt/point40/77.jpg'],
        excelLink: ['Dronningens_distrikt/point40/point40_75_1.xlsx',
                    'Dronningens_distrikt/point40/point40_77_1.xlsx']
    },

     {
        coordinates: [17.713051, -64.727755],
        navn: "Matrikel nr. 44a, Hum Bucg",
        nabolag: "Dronningens Kvarter",
        ejer: " Johannes Heyligare ABZ",
        image: 'Dronningens_distrikt/point44/84.jpg',
        excelLink: 'Dronningens_distrikt/point44/point44_84_1.xlsx'
    },
     {
        coordinates: [17.704016, -64.726982],
        navn: "Matrikel nr. 45, Cane Garden",
        nabolag: "Dronningens Kvarter",
        ejer: " Jasper Parson",
        image: 'Dronningens_distrikt/point45/85.jpg',
        excelLink: 'Dronningens_distrikt/point45/point45_85_1.xlsx'
    },

    {        coordinates: [17.716403, -64.743934],
        navn: "Matrikel nr. 49, Jerusalem",
        nabolag: "Dronningens Kvarter",
        ejer: "Jugde Winding & John Wells ",
        image: ['Dronningens_distrikt/point49/87.jpg',
                'Dronningens_distrikt/point49/89.jpg'],
        excelLink: ['Dronningens_distrikt/point49/point49_87_1.xlsx',
                    'Dronningens_distrikt/point49/point49_89_1.xlsx']
    },
    
 // Kompagniets Kvarter
    {
        coordinates: [17.750487, -64.721364],
        navn: "Matrikel nr. 4, Golden Rock ",
        nabolag: "Kompagniets Kvarter",
        ejer: "James Forbes",
        image: 'Kompagniets_distrikt/Point4/9.jpg',
        excelLink: 'Kompagniets_distrikt/Point4/point4_9_2.xlsx'
    },
    {
        coordinates: [17.738825, -64.722948],
        navn: "Matrikel nr. 6, Beeston hil/Bidsted hill",
        nabolag: "Kompagniets Kvarter",
        ejer: "George Park",
        image: 'Kompagniets_distrikt/Point6/7.jpg',
        excelLink: 'Kompagniets_distrikt/Point6/point6_7_2.xlsx'
    },
    {
        coordinates: [17.725249, -64.711715],
        navn: "Matrikel nr. 12, 14, 20 & 21, Catharianas Reest",
        nabolag: "Kompagniets Kvarter",
        ejer: "Heies of C: De Nully",
        image: 'Kompagniets_distrikt/Point12&14&20&21/21.jpg',
        excelLink: 'Kompagniets_distrikt/Point12&14&20&21/Point12_21_2.xlsx'
    },
    {
        coordinates: [17.712029, -64.722862],
        navn: "Matrikel nr. 16",
        nabolag: "Kompagniets Kvarter",
        ejer: "Friederich Baron de Bretton",
        image: 'Kompagniets_distrikt/Point16/23.jpg',
        excelLink: 'Kompagniets_distrikt/Point16/point16_23_2.xlsx'
    },
    {
        coordinates: [17.726582, -64.70016],
        navn: "Matrikel nr. 21",
        nabolag: "Kompagniets Kvarter",
        ejer: "Mary Key",
        image: 'Kompagniets_distrikt/Point21/40.jpg',
        excelLink: 'Kompagniets_distrikt/Point21/Point21_40_2.xlsx'
    },
    {
        coordinates: [17.729893, -64.692371],
        navn: "Matrikel nr. 23, Spring Garden",
        nabolag: "Kompagniets Kvarter",
        ejer: "Heirs of John & Elizabeth Boakley",
        image: 'Kompagniets_distrikt/Point23/34.jpg',
        excelLink: 'Kompagniets_distrikt/Point23/Point23_34_2.xlsx'
    },
    {
        coordinates: [17.708268, -64.714773],
        navn: "Matrikel nr. 31, Diamond Estate",
        nabolag: "Kompagniets Kvarter",
        ejer: "Gen C. Lindemann",
        image: 'Kompagniets_distrikt/Point31/39.jpg',
        excelLink: 'Kompagniets_distrikt/Point31/Point31_39_2.xlsx'
    },
    {
        coordinates: [17.745058, -64.732518],
        navn: "Matrikel nr. 35, Bellevue Estate",
        nabolag: "Kompagniets Kvarter",
        ejer: "Mrs. Anna Linberg",
        image: 'Kompagniets_distrikt/Point35_43_2/43.jpg',
        excelLink: 'Kompagniets_distrikt/Point35_43_2/Point35_43_2.xlsx'
    },
      // Kongens_distrikt
      {
                coordinates: [17.735187, -64.773395],
                navn: "Matrikel nr. 20, La Reine",
                nabolag: "Kongens Kvarter",
                ejer: "John Ryan Esquire",
                image: [
                    'Kongens_distrikt/Point20/172.jpg',
                    'Kongens_distrikt/Point20/175.jpg'
                ],
                excelLink: [
                    'Kongens_distrikt/Point20/Point20_172_2.xlsx',
                    'Kongens_distrikt/Point20/Point20_175_2.xlsx'
                ]
            },
    {
        coordinates: [17.724395, -64.776657],
        navn: "Matrikel nr. 22, Clifton Hill",
        nabolag: "Kongens Kvarter",
        ejer: "Edward Murphy",
        image: 'Kongens_distrikt/Point22/183.jpg',
        excelLink: 'Kongens_distrikt/Point22/Point22_183_2.xlsx'
    },
    {
        coordinates: [17.718549, -64.779553],
        navn: "Matrikel nr. 28",
        nabolag: "Kongens Kvarter",
        ejer: "John G. Krause",
        image: [
                    'Kongens_distrikt/Point28/188.jpg',
                    'Kongens_distrikt/Point28/189.jpg'
                ],
                excelLink: [
                    'Kongens_distrikt/Point28/Point28_188_2.xlsx',
                    'Kongens_distrikt/Point28/Point28_189_2.xlsx'
                ]
            },
            {
        coordinates: [17.715545, -64.774039],
        navn: "Matrikel nr. 29",
        nabolag: "Kongens Kvarter",
        ejer: "Abrame Markoe Senior",
        image: [
                    'Kongens_distrikt/Point29_/190.jpg',
                    'Kongens_distrikt/Point29_/191.jpg'
                ],
                excelLink: [
                    'Kongens_distrikt/Point29_/Point_29_190_2.xlsx',
                    'Kongens_distrikt/Point29_/Point29_191_2.xlsx'
                ]
            },
            {
        coordinates: [17.713705, -64.765391],
        navn: "Matrikel nr. 30 & 31, the estate Blessing",
        nabolag: "Kongens Kvarter",
        ejer: "Joe Johnson",
        image: [
                    'Kongens_distrikt/Point30&31_192_2/192.jpg',
                    'Kongens_distrikt/Point30&31_192_2/196.jpg'
                ],
                excelLink: [
                    'Kongens_distrikt/Point30&31_192_2/Point_30&31_192_2.xlsx',
                    'Kongens_distrikt/Point30&31_192_2/Point_30&31_196_2.xlsx'
                ]
            },
    {
        coordinates: [17.707103, -64.780154],
        navn: "Matrikel nr. 32 & 33, Anguilla Estate",
        nabolag: "Kongens Kvarter",
        ejer: "Mary Turnbull",
        image: [
                    'Kongens_distrikt/Point32_33/198.jpg',
                    'Kongens_distrikt/Point32_33/199.jpg'
                ],
                excelLink: [
                    'Kongens_distrikt/Point32_33/point32&33_198_2.xlsx',
                    'Kongens_distrikt/Point32_33/point32&33_199_2.xlsx'
                ]
            },
   {
        coordinates: [17.708113, -64.781656],
        navn: "Matrikel nr. 33 A, Bethlehem Estate",
        nabolag: "Kongens Kvarter",
        ejer: "Junior Jeb Dewind Esqr",
        image: 'Kongens_distrikt/Point33a_204_2/204.jpg',
        excelLink: 'Kongens_distrikt/Point33a_204_2/point33_204_2.xlsx'
    },
    // North_Side_ A_distrikt
    {
        coordinates: [17.74933, -64.86036],
        navn: "Matrikel nr. 17, Rose Hill Estate",
        nabolag: "North side A",
        ejer: "Seth & Thomas Smith",
        image: [
                    'North_Side_ A_distrikt/Point17_99_2/99.jpg',
                    'North_Side_ A_distrikt/Point17_99_2/100.jpg',
                    'North_Side_ A_distrikt/Point17_99_2/102.jpg',
                    'North_Side_ A_distrikt/Point17_99_2/103.jpg'
                ],
                excelLink: [
                    'North_Side_ A_distrikt/Point17_99_2/Point17_99_2.xlsx',
                    'North_Side_ A_distrikt/Point17_99_2/Point17_100_2.xlsx',
                    'North_Side_ A_distrikt/Point17_99_2/Point17_102_2.xlsx',
                    'North_Side_ A_distrikt/Point17_99_2/Point17_103_2.xlsx'
                ]
            },
     // Northside B Kvarter
     // West_ End_distrikt
     {
        coordinates: [17.760000, -64.740000],
        navn: "Sted nr. 3",
        nabolag: "West Ende",
        ejer: "Ejeren 3",
        image: 'West_ End_distrikt/Point3/3.jpg',
        excelLink: 'West_ End_distrikt/Point3/table_3.xlsx'
    },

];

  // Iterér gennem punkterne og tilføj dem til kortet
  points.forEach(function(point) {
            const marker = L.circleMarker(point.coordinates, {
                radius: 8,
                color: '#ff7800',
                weight: 1,
                opacity: 1,
                fillOpacity: 0.8
            }).bindPopup(`
                <div class="popup-content">
                    <strong>Navn: ${point.navn}</strong><br>
                    <strong>Nabolag: ${point.nabolag}</strong><br>
                    <strong>Ejer: ${point.ejer}</strong><br>
                    <div>
                        <strong>Billeder:</strong><br>
                        ${Array.isArray(point.image) ? point.image.map(img => 
                            `<img src="${img}" alt="Billede">
                            <button onclick="openFullscreen('${img}')">Vis i Fuldskærm</button><br>`).join('') : 
                            `<img src="${point.image}" alt="Billede">
                            <button onclick="openFullscreen('${point.image}')">Vis i Fuldskærm</button><br>`}
                    </div>
                    <div>
                        <strong>Excel Filer:</strong><br>
                        ${Array.isArray(point.excelLink) ? point.excelLink.map(file => 
                            `<button onclick="readExcel('${file}')">Læs Excel fil</button>
                            <button onclick="showExcelFullscreen()">Vis i Fuldskærm</button><br>`).join('') : 
                            `<button onclick="readExcel('${point.excelLink}')">Læs Excel fil</button>
                            <button onclick="showExcelFullscreen()">Vis i Fuldskærm</button><br>`}
                    </div>
                    <div class="excel-table" id="excelContent"></div>
                </div>
            `).addTo(map);
        });


        // Funktion til at åbne billedet i fuldskærm
        function openFullscreen(imgSrc) {
            const img = document.createElement('img');
            img.src = imgSrc;
            img.style.width = '100%';
            img.style.height = '100%';
            img.style.objectFit = 'contain'; // Beholder billedets proportioner
            img.style.position = 'fixed';
            img.style.top = '0';
            img.style.left = '0';
            img.style.zIndex = '10000'; // Sørg for, at billedet er oven på alt andet
            img.onclick = function() {
                document.body.removeChild(img); // Luk fuldskærm ved at klikke
            };
            document.body.appendChild(img); // Tilføj billedet til body
        }

        // Funktion til at læse Excel-filen og vise indholdet
        function readExcel(file) {
            const xhr = new XMLHttpRequest();
            xhr.open('GET', file, true);
            xhr.responseType = 'arraybuffer';

            xhr.onload = function(e) {
                const data = new Uint8Array(xhr.response);
                const workbook = XLSX.read(data, { type: 'array' });
                const firstSheetName = workbook.SheetNames[0];
                const worksheet = workbook.Sheets[firstSheetName];

                // Generer HTML fra Excel-data
                const html = XLSX.utils.sheet_to_html(worksheet, { header: 1 });
                document.getElementById('excelContent').innerHTML = html;
            };

            xhr.send();
        }

        // Funktion til at vise Excel i fuldskærm
        function showExcelFullscreen() {
            const excelContent = document.getElementById('excelContent');
            if (excelContent && excelContent.innerHTML.trim() !== "") {
                const fullScreenDiv = document.createElement('div');
                fullScreenDiv.style.position = 'fixed';
                fullScreenDiv.style.top = '0';
                fullScreenDiv.style.left = '0';
                fullScreenDiv.style.width = '100%';
                fullScreenDiv.style.height = '100%';
                fullScreenDiv.style.backgroundColor = 'white';
                fullScreenDiv.style.zIndex = '10000';
                fullScreenDiv.style.overflow = 'auto';
                fullScreenDiv.innerHTML = `<h2>Excel Indhold</h2>${excelContent.innerHTML}`;
                fullScreenDiv.onclick = function() {
                    document.body.removeChild(fullScreenDiv); // Luk fuldskærm ved at klikke
                };
                document.body.appendChild(fullScreenDiv); // Tilføj fuldskærm div til body
            } else {
                alert("Indlæs Excel-filen først for at vise den i fuldskærm!");
            }
        }

        // Aktiver måleværktøj
        var drawnItems = new L.FeatureGroup();
        map.addLayer(drawnItems);
        var drawControl = new L.Control.Draw({
            edit: {
                featureGroup: drawnItems
            },
            draw: {
                polygon: true,
                polyline: true,
                rectangle: true,
                circle: true,
                marker: true,
                circlemarker: false
            }
        });

        document.getElementById('measureBtn').onclick = function() {
            map.addControl(drawControl);
            document.getElementById('measureBtn').style.display = 'none';
            document.getElementById('stopMeasureBtn').style.display = 'inline';
        };

        document.getElementById('stopMeasureBtn').onclick = function() {
            map.removeControl(drawControl);
            document.getElementById('measureBtn').style.display = 'inline';
            document.getElementById('stopMeasureBtn').style.display = 'none';
        };

        // Aktiver koordinatvælger
        map.on('click', function(e) {
            if (document.getElementById('coordinateBtn').style.display === 'none') {
                alert("Koordinater: " + e.latlng.toString());
            }
        });

        document.getElementById('coordinateBtn').onclick = function() {
            document.getElementById('coordinateBtn').style.display = 'none';
            document.getElementById('stopCoordinateBtn').style.display = 'inline';
        };

        document.getElementById('stopCoordinateBtn').onclick = function() {
            document.getElementById('coordinateBtn').style.display = 'inline';
            document.getElementById('stopCoordinateBtn').style.display = 'none';
        };

        // Håndter tegningsfunktionalitet
        map.on(L.Draw.Event.CREATED, function(e) {
            var layer = e.layer;
            drawnItems.addLayer(layer);
        });
    </script>
</body>
</html>
